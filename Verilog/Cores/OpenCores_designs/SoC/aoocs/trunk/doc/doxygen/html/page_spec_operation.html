<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>aoOCS: Operation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Design&#160;Unit&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="index.html">index</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Operation </h1>  </div>
</div>
<div class="contents">
<h3>SD card</h3>
<p>The <a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> SoC requires a SD card containing a list of available ROMs and floppy images together with images themselves. The <a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> does not support any filesystem on the card. A binary image file must be prepared and written on the card starting at sector 0. The aoOCS_tool is used to prepare the image in the following way:</p>
<ul>
<li>a title screen PNG image must be available. A default image is available at <code></code>./sw/aoOCS_tool/title.png</li>
<li>a directory with ROM files must be created</li>
<li>a directory with floppy images (ADF files) must be created</li>
<li>the following <code>make</code> command must be run at the base directory of the project: <div class="fragment"><pre class="fragment">
  make sd_disk AO_INTRO_IMAGE=&lt;path to title screen PNG image&gt; AO_ROMS=&lt;path to ROMs directory&gt; AO_FLOPPIES=&lt;path to floppy images directory&gt;
  </pre></div></li>
<li>The SD disk image is generated and saved to <code></code>./tmp/sd_disk.img. That image must be written directly on a SD disk bypassing and most probably destroying the filesystem on the disk. The easiest way to write the image is to run the <code>dd</code> command as a super-user on a Linux system: <div class="fragment"><pre class="fragment">
  dd if=&lt;path to image file&gt; of=&lt;path to SD device&gt;
  </pre></div></li>
</ul>
<h3>aoOCS_tool</h3>
<p>The aoOCS_tool is used to:</p>
<ul>
<li>Create the contents of the SD card. A image containing: a title screen, ROMs and floppy disk ADF files is created. This image has to be written to the SD card starting from sector 0.</li>
<li>Extract vga frames from the <a class="el" href="classdrv__eth__vga__capture.html" title="DM9000A 10/100 Mbit Ethernet driver for a VGA frame grabber. ">drv_eth_vga_capture</a> module as PNG images.</li>
<li>Generate <code>./rtl/control_osd.mif</code> memory initialization file with On-Screen-Display text strings.</li>
<li>Extract the specification contents from Doxygen HTML output, to generate the specification ODT file.</li>
</ul>
<p>The source code for the tool is located at: <code>./sw/aoOCS_tool/</code>.</p>
<h3>On-Screen-Display description</h3>
<ul>
<li>After powerup or reset, the SoC tries to initialize the SD card and read the title screen, list of ROM files and list of floppy files. If all goes well, the following screen is displayed: <div align="center">
<img src="vga_title.png" alt="vga_title.png"/>
<p><strong>aoOCS title screen with ROM selection menu</strong></p></div>
</li>
<li>The On-Screen-Display is controlled by the keyboard arrow Up and Down keys. To select an item use the right Control key: <div align="center">
<img src="vga_menu_sel_wb.png" alt="vga_menu_sel_wb.png"/>
<p><strong>aoOCS floppy selection menu with Amiga Workbench 1.2 floppy highlighted</strong></p></div>
</li>
<li>After selecting the ROM file, the menu disappears and the Amiga boots from the ROM: <div align="center">
<img src="vga_kick12.png" alt="vga_kick12.png"/>
<p><strong>Amiga Kickstart v1.2 bootstrap screen</strong></p></div>
</li>
<li>To select a floppy disk to insert into the internal disk drive, the On-Screen-Display is used. To display the menu press the Home key. The Home key is also used to hide the menu. The menu when no floppy is inserted looks like this: <div align="center">
<img src="vga_menu_no_floppy.png" alt="vga_menu_no_floppy.png"/>
<p><strong>aoOCS floppy selection menu</strong></p></div>
</li>
<li>The following options are available:<ul>
<li><code>Joystick (kbd arrows)</code>: enable or disable the joystick on Amiga port 1. The joystick is controlled by the keyboard arrow keys and the right Control key. When enabled, the arrow keys are unavailable to the Amiga keyboard - the key strokes are redirected to the joystick.</li>
<li><code>Floppy write enabled</code>: enable or disable floppy writes. The floppy changes are made directly on the SD disk.</li>
<li><code>Reset</code>: reset the <a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> SoC</li>
<li>Below is a list of available floppy disks to insert. After selecting a floppy the display changes to the following: <div align="center">
<img src="vga_menu_floppy_inserted.png" alt="vga_menu_floppy_inserted.png"/>
<p><strong>aoOCS menu after floppy selection</strong></p></div>
</li>
</ul>
</li>
<li>In this menu it is possible to eject the floppy disk. After ejecting the floppy the previous menu is dispayed.</li>
</ul>
<h3>Software compatability list</h3>
<p>The state of software can be: </p>
<table  border="0">
<tr>
<td><em>PERFECT</em> </td><td>no visible and no audible distortions </td></tr>
<tr>
<td><em>GOOD</em> </td><td>some minor distortions </td></tr>
<tr>
<td><em>FAIR</em> </td><td>software starts but has major distortions </td></tr>
<tr>
<td><em>FAILED</em> </td><td>software does not start </td></tr>
</table>
<ul>
<li>Amiga Workbench version 1.2 <div align="center"><table  width="100%">
<tr>
<td width="300"><table class="doxtable">
<tr>
<td><b><a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> version:</b> </td><td>1.0  </td></tr>
<tr>
<td><b>State:</b> </td><td><em>GOOD</em>  </td></tr>
<tr>
<td><b>Description:</b> </td><td>Some minor graphic problems: bottom of screen not displayed correctly. Most probably problem with Copper and vertical beam position. </td></tr>
</table>
</td><td><div align="center">
<img src="vga_wb12.png" alt="vga_wb12.png"/>
<p><strong>Amiga Workbench v1.2 screen</strong></p></div>
 </td></tr>
</table>
</div></li>
</ul>
<ul>
<li>Prince of Persia <div align="center"><table  width="100%">
<tr>
<td width="300"><table class="doxtable">
<tr>
<td><b><a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> version:</b> </td><td>1.0  </td></tr>
<tr>
<td><b>State:</b> </td><td><em>PERFECT</em>  </td></tr>
<tr>
<td><b>Description:</b> </td><td>No problems. </td></tr>
</table>
</td><td><div align="center">
<img src="vga_prince_of_persia.png" alt="vga_prince_of_persia.png"/>
<p><strong>Prince of Persia</strong></p></div>
 </td></tr>
</table>
</div></li>
</ul>
<ul>
<li>Wings of Fury <div align="center"><table  width="100%">
<tr>
<td width="300"><table class="doxtable">
<tr>
<td><b><a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> version:</b> </td><td>1.0  </td></tr>
<tr>
<td><b>State:</b> </td><td><em>GOOD</em>  </td></tr>
<tr>
<td><b>Description:</b> </td><td>Some sound gliches in introduction. The game itself works perfect. </td></tr>
</table>
</td><td><div align="center">
<img src="vga_wings_of_fury.png" alt="vga_wings_of_fury.png"/>
<p><strong>Wing of Fury</strong></p></div>
 </td></tr>
</table>
</div></li>
</ul>
<ul>
<li>Lotus 2 <div align="center"><table  width="100%">
<tr>
<td width="300"><table class="doxtable">
<tr>
<td><b><a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> version:</b> </td><td>1.0  </td></tr>
<tr>
<td><b>State:</b> </td><td><em>GOOD</em>  </td></tr>
<tr>
<td><b>Description:</b> </td><td>Some minor sound problems in introduction - most probably some bug in the low-pass filter or channel modulation. The VGA frame was captured in the middle of screen update so there are some distortions. In real-time in looks OK. </td></tr>
</table>
</td><td><div align="center">
<img src="vga_lotus2.png" alt="vga_lotus2.png"/>
<p><strong>Lotus 2</strong></p></div>
 </td></tr>
</table>
</div></li>
</ul>
<ul>
<li>Warzone <div align="center"><table  width="100%">
<tr>
<td width="300"><table class="doxtable">
<tr>
<td><b><a class="el" href="classaoOCS.html" title="aoOCS top-level module for the Terasic DE2-70 board. ">aoOCS</a> version:</b> </td><td>1.0  </td></tr>
<tr>
<td><b>State:</b> </td><td><em>FAIR</em>  </td></tr>
<tr>
<td><b>Description:</b> </td><td>Major graphic problems - as seen on captured VGA frame. </td></tr>
</table>
</td><td><div align="center">
<img src="vga_warzone.png" alt="vga_warzone.png"/>
<p><strong>Warzone</strong></p></div>
 </td></tr>
</table>
</div> </li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Mon Dec 20 2010 21:20:19 for aoOCS by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
