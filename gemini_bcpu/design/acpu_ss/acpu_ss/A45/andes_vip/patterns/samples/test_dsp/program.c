#include <inttypes.h>

#include "ndslib.h"
#include "core_v5.h"
#include "interrupt.h"
#include "dsp.h"

#define CHECK_DSP(CMD, RD, OV) \
	if((RD) != (CMD))           exit(1); \
	if((OV) != __nds__rdov())   exit(1); \
	__nds__clrov()


void check_dsp(void);
void ecall_handler(SAVED_CONTEXT * context) {
	context->mepc = read_csr(NDS_MEPC) + 4;

	// Read MMSC_CFG
	long mmsc_cfg = read_csr(NDS_MMSC_CFG);

	// check dsp enable
	if (! (mmsc_cfg & (0x1<<29))) {
		skip("'RISC-V P-extension (draft) DSP/SIMD ISA' should be configured to run this test.\n");
	}
}


int main (int argc, char** argv) {
	general_exc_handler_tab[TRAP_U_ECALL] = ecall_handler;
	general_exc_handler_tab[TRAP_S_ECALL] = ecall_handler;
	general_exc_handler_tab[TRAP_M_ECALL] = ecall_handler;
	asm volatile("ecall");

	check_dsp();
}
void check_dsp(void)
{
	volatile const unsigned long long r = 0xffffffffffffffff;
	volatile const unsigned long long a = 0x89abcdef89abcdef;
	volatile const unsigned long long b = 0xdeadbeefdeadbeef;

#if __riscv_xlen == 64
        CHECK_DSP(__nds__add16(a, b), 0x68588cde68588cde, 0);
        CHECK_DSP(__nds__radd16(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__uradd16(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__kadd16(a, b), 0x80008cde80008cde, 1);
        CHECK_DSP(__nds__ukadd16(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__sub16(a, b), 0xaafe0f00aafe0f00, 0);
        CHECK_DSP(__nds__rsub16(a, b), 0xd57f0780d57f0780, 0);
        CHECK_DSP(__nds__ursub16(a, b), 0xd57f0780d57f0780, 0);
        CHECK_DSP(__nds__ksub16(a, b), 0xaafe0f00aafe0f00, 0);
        CHECK_DSP(__nds__uksub16(a, b), 0x00000f0000000f00, 1);
        CHECK_DSP(__nds__stas16(a, b), 0x68580f0068580f00, 0);
        CHECK_DSP(__nds__rstas16(a, b), 0xb42c0780b42c0780, 0);
        CHECK_DSP(__nds__urstas16(a, b), 0xb42c0780b42c0780, 0);
        CHECK_DSP(__nds__kstas16(a, b), 0x80000f0080000f00, 1);
        CHECK_DSP(__nds__ukstas16(a, b), 0xffff0f00ffff0f00, 1);
        CHECK_DSP(__nds__stsa16(a, b), 0xaafe8cdeaafe8cde, 0);
        CHECK_DSP(__nds__rstsa16(a, b), 0xd57fc66fd57fc66f, 0);
        CHECK_DSP(__nds__urstsa16(a, b), 0xd57fc66fd57fc66f, 0);
        CHECK_DSP(__nds__kstsa16(a, b), 0xaafe8cdeaafe8cde, 0);
        CHECK_DSP(__nds__ukstsa16(a, b), 0x0000ffff0000ffff, 1);
        CHECK_DSP(__nds__cras16(a, b), 0x489aef42489aef42, 0);
        CHECK_DSP(__nds__rcras16(a, b), 0xa44df7a1a44df7a1, 0);
        CHECK_DSP(__nds__urcras16(a, b), 0xa44df7a1a44df7a1, 0);
        CHECK_DSP(__nds__kcras16(a, b), 0x8000ef428000ef42, 1);
        CHECK_DSP(__nds__ukcras16(a, b), 0xffff0000ffff0000, 1);
        CHECK_DSP(__nds__crsa16(a, b), 0xcabcac9ccabcac9c, 0);
        CHECK_DSP(__nds__rcrsa16(a, b), 0xe55ed64ee55ed64e, 0);
        CHECK_DSP(__nds__urcrsa16(a, b), 0xe55ed64ee55ed64e, 0);
        CHECK_DSP(__nds__kcrsa16(a, b), 0xcabcac9ccabcac9c, 0);
        CHECK_DSP(__nds__ukcrsa16(a, b), 0x0000ffff0000ffff, 1);
        CHECK_DSP(__nds__sra16(a, b), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__sra16(a, 0xF), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__sra16_u(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__sra16_u(a, 0xF), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__srl16(a, b), 0x0001000100010001, 0);
        CHECK_DSP(__nds__srl16(a, 0xF), 0x0001000100010001, 0);
        CHECK_DSP(__nds__srl16_u(a, b), 0x0001000200010002, 0);
        CHECK_DSP(__nds__srl16_u(a, 0xF), 0x0001000200010002, 0);
        CHECK_DSP(__nds__sll16(a, b), 0x8000800080008000, 0);
        CHECK_DSP(__nds__sll16(a, 0xF), 0x8000800080008000, 0);
        CHECK_DSP(__nds__ksll16(a, b), 0x8000800080008000, 1);
        CHECK_DSP(__nds__ksll16(a, 0xF), 0x8000800080008000, 1);
        CHECK_DSP(__nds__kslra16(a, b), 0x8000800080008000, 1);
        CHECK_DSP(__nds__kslra16_u(a, b), 0x8000800080008000, 1);
        CHECK_DSP(__nds__cmpeq16(a, b), 0x0000000000000000, 0);
        CHECK_DSP(__nds__scmplt16(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__ucmplt16(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__scmple16(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__ucmple16(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__smin16(a, b), 0x89abbeef89abbeef, 0);
        CHECK_DSP(__nds__umin16(a, b), 0x89abbeef89abbeef, 0);
        CHECK_DSP(__nds__smax16(a, b), 0xdeadcdefdeadcdef, 0);
        CHECK_DSP(__nds__umax16(a, b), 0xdeadcdefdeadcdef, 0);
        CHECK_DSP(__nds__kabs16(a), 0x7655321176553211, 0);
        CHECK_DSP(__nds__sclip16(a, 0xF), 0x89abcdef89abcdef, 0);
        CHECK_DSP(__nds__uclip16(a, 0xF), 0x0000000000000000, 1);
        CHECK_DSP(__nds__khm16(a, b), 0x1ece19731ece1973, 0);
        CHECK_DSP(__nds__khmx16(a, b), 0x3c260d083c260d08, 0);
        CHECK_DSP(__nds__swap16(a), 0xcdef89abcdef89ab, 0);
        CHECK_DSP(__nds__clz16(a), 0x0000000000000000, 0);
        CHECK_DSP(__nds__clo16(a), 0x0001000200010002, 0);
        CHECK_DSP(__nds__clrs16(a), 0x0000000100000001, 0);
        CHECK_DSP(__nds__add8(a, b), 0x67588bde67588bde, 0);
        CHECK_DSP(__nds__radd8(a, b), 0xb3acc5efb3acc5ef, 0);
        CHECK_DSP(__nds__uradd8(a, b), 0xb3acc5efb3acc5ef, 0);
        CHECK_DSP(__nds__kadd8(a, b), 0x80808bde80808bde, 1);
        CHECK_DSP(__nds__ukadd8(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__sub8(a, b), 0xabfe0f00abfe0f00, 0);
        CHECK_DSP(__nds__rsub8(a, b), 0xd5ff0700d5ff0700, 0);
        CHECK_DSP(__nds__ursub8(a, b), 0xd5ff0700d5ff0700, 0);
        CHECK_DSP(__nds__ksub8(a, b), 0xabfe0f00abfe0f00, 0);
        CHECK_DSP(__nds__uksub8(a, b), 0x00000f0000000f00, 1);
        CHECK_DSP(__nds__sra8(a, b), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__sra8(a, 0x7), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__sra8_u(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__sra8_u(a, 0x7), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__srl8(a, b), 0x0101010101010101, 0);
        CHECK_DSP(__nds__srl8(a, 0x7), 0x0101010101010101, 0);
        CHECK_DSP(__nds__srl8_u(a, b), 0x0101020201010202, 0);
        CHECK_DSP(__nds__srl8_u(a, 0x7), 0x0101020201010202, 0);
        CHECK_DSP(__nds__sll8(a, b), 0x8080808080808080, 0);
        CHECK_DSP(__nds__sll8(a, 0x7), 0x8080808080808080, 0);
        CHECK_DSP(__nds__ksll8(a, b), 0x8080808080808080, 1);
        CHECK_DSP(__nds__ksll8(a, 0x7), 0x8080808080808080, 1);
        CHECK_DSP(__nds__kslra8(a, b), 0xc4d5e6f7c4d5e6f7, 0);
        CHECK_DSP(__nds__kslra8_u(a, b), 0xc5d6e7f8c5d6e7f8, 0);
        CHECK_DSP(__nds__cmpeq8(a, b), 0x000000ff000000ff, 0);
        CHECK_DSP(__nds__scmplt8(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__ucmplt8(a, b), 0xffff0000ffff0000, 0);
        CHECK_DSP(__nds__scmple8(a, b), 0xffff00ffffff00ff, 0);
        CHECK_DSP(__nds__ucmple8(a, b), 0xffff00ffffff00ff, 0);
        CHECK_DSP(__nds__smin8(a, b), 0x89abbeef89abbeef, 0);
        CHECK_DSP(__nds__umin8(a, b), 0x89abbeef89abbeef, 0);
        CHECK_DSP(__nds__smax8(a, b), 0xdeadcdefdeadcdef, 0);
        CHECK_DSP(__nds__umax8(a, b), 0xdeadcdefdeadcdef, 0);
        CHECK_DSP(__nds__kabs8(a), 0x7755331177553311, 0);
        CHECK_DSP(__nds__sclip8(a, 0x7), 0x89abcdef89abcdef, 0);
        CHECK_DSP(__nds__uclip8(a, 0x7), 0x0000000000000000, 1);
        CHECK_DSP(__nds__khm8(a, b), 0x1f371a021f371a02, 0);
        CHECK_DSP(__nds__khmx8(a, b), 0x4d1606084d160608, 0);
        CHECK_DSP(__nds__swap8(a), 0xab89efcdab89efcd, 0);
        CHECK_DSP(__nds__clz8(a), 0x0000000000000000, 0);
        CHECK_DSP(__nds__clo8(a), 0x0101020301010203, 0);
        CHECK_DSP(__nds__clrs8(a), 0x0000010200000102, 0);
        CHECK_DSP(__nds__sunpkd810(a), 0xffcdffefffcdffef, 0);
        CHECK_DSP(__nds__sunpkd820(a), 0xffabffefffabffef, 0);
        CHECK_DSP(__nds__sunpkd830(a), 0xff89ffefff89ffef, 0);
        CHECK_DSP(__nds__sunpkd831(a), 0xff89ffcdff89ffcd, 0);
        CHECK_DSP(__nds__sunpkd832(a), 0xff89ffabff89ffab, 0);
        CHECK_DSP(__nds__zunpkd810(a), 0x00cd00ef00cd00ef, 0);
        CHECK_DSP(__nds__zunpkd820(a), 0x00ab00ef00ab00ef, 0);
        CHECK_DSP(__nds__zunpkd830(a), 0x008900ef008900ef, 0);
        CHECK_DSP(__nds__zunpkd831(a), 0x008900cd008900cd, 0);
        CHECK_DSP(__nds__zunpkd832(a), 0x008900ab008900ab, 0);
        CHECK_DSP(__nds__raddw(a, b), 0xffffffffb42cc66f, 0);
        CHECK_DSP(__nds__uraddw(a, b), 0xffffffffb42cc66f, 0);
        CHECK_DSP(__nds__rsubw(a, b), 0xffffffffd57f0780, 0);
        CHECK_DSP(__nds__ursubw(a, b), 0xffffffffd57f0780, 0);
        CHECK_DSP(__nds__sra_u(a, b), 0xffffffffffff1358, 0);
        CHECK_DSP(__nds__sra_u(a, 0x1F), 0xffffffff13579bdf, 0);
        CHECK_DSP(__nds__ksllw(a, b), 0xffffffff80000000, 1);
        CHECK_DSP(__nds__ksllw(a, 0x1F), 0xffffffff80000000, 1);
        CHECK_DSP(__nds__pkbb16(a, b), 0xcdefbeefcdefbeef, 0);
        CHECK_DSP(__nds__pkbt16(a, b), 0xcdefdeadcdefdead, 0);
        CHECK_DSP(__nds__pktb16(a, b), 0x89abbeef89abbeef, 0);
        CHECK_DSP(__nds__pktt16(a, b), 0x89abdead89abdead, 0);
        CHECK_DSP(__nds__sclip32(a, 0x1F), 0x89abcdef89abcdef, 0);
        CHECK_DSP(__nds__uclip32(a, 0x1F), 0x0000000000000000, 1);
        CHECK_DSP(__nds__bitrev(a, b), 0x0000f7b3d591f7b3, 0);
        CHECK_DSP(__nds__bitrev(a, 0x1F), 0x00000000f7b3d591, 0);
        CHECK_DSP(__nds__wext(a, b), 0xffffffff9bdf1357, 0);
        CHECK_DSP(__nds__wexti(a, 0x1F), 0x0000000013579bdf, 0);
        CHECK_DSP(__nds__bpick(r, a, b), 0xdfafffefdfafffef, 0);
        CHECK_DSP(__nds__insb(r, a, 0x2), 0xffffffffffefffff, 0);
        CHECK_DSP(__nds__minw(a, b), 0xffffffff89abcdef, 0);
        CHECK_DSP(__nds__maxw(a, b), 0xffffffffdeadbeef, 0);
        CHECK_DSP(__nds__kabsw(a), 0x0000000076543211, 0);
        CHECK_DSP(__nds__clz32(a), 0x0000000000000000, 0);
        CHECK_DSP(__nds__clo32(a), 0x0000000100000001, 0);
        CHECK_DSP(__nds__clrs32(a), 0x0000000000000000, 0);
        CHECK_DSP(__nds__smmul(a, b), 0x0f66df7f0f66df7f, 0);
        CHECK_DSP(__nds__smmul_u(a, b), 0x0f66df7f0f66df7f, 0);
        CHECK_DSP(__nds__kmmac(r, a, b), 0x0f66df7e0f66df7e, 0);
        CHECK_DSP(__nds__kmmac_u(r, a, b), 0x0f66df7e0f66df7e, 0);
        CHECK_DSP(__nds__kmmsb(r, a, b), 0xf0992080f0992080, 0);
        CHECK_DSP(__nds__kmmsb_u(r, a, b), 0xf0992080f0992080, 0);
        CHECK_DSP(__nds__kwmmul(a, b), 0x1ecdbefe1ecdbefe, 0);
        CHECK_DSP(__nds__kwmmul_u(a, b), 0x1ecdbeff1ecdbeff, 0);
        CHECK_DSP(__nds__maddr32(r, a, b), 0x0000000076bfa420, 0);
        CHECK_DSP(__nds__msubr32(r, a, b), 0xffffffff89405bde, 0);
        CHECK_DSP(__nds__smmwb(a, b), 0x1e133c4d1e133c4d, 0);
        CHECK_DSP(__nds__smmwb_u(a, b), 0x1e133c4e1e133c4e, 0);
        CHECK_DSP(__nds__smmwt(a, b), 0x0f6737c00f6737c0, 0);
        CHECK_DSP(__nds__smmwt_u(a, b), 0x0f6737c00f6737c0, 0);
        CHECK_DSP(__nds__kmmawb(r, a, b), 0x1e133c4c1e133c4c, 0);
        CHECK_DSP(__nds__kmmawb_u(r, a, b), 0x1e133c4d1e133c4d, 0);
        CHECK_DSP(__nds__kmmawt(r, a, b), 0x0f6737bf0f6737bf, 0);
        CHECK_DSP(__nds__kmmawt_u(r, a, b), 0x0f6737bf0f6737bf, 0);
        CHECK_DSP(__nds__kmmwb2(a, b), 0x3c26789b3c26789b, 0);
        CHECK_DSP(__nds__kmmwb2_u(a, b), 0x3c26789b3c26789b, 0);
        CHECK_DSP(__nds__kmmwt2(a, b), 0x1ece6f801ece6f80, 0);
        CHECK_DSP(__nds__kmmwt2_u(a, b), 0x1ece6f811ece6f81, 0);
        CHECK_DSP(__nds__kmmawb2(r, a, b), 0x3c26789a3c26789a, 0);
        CHECK_DSP(__nds__kmmawb2_u(r, a, b), 0x3c26789a3c26789a, 0);
        CHECK_DSP(__nds__kmmawt2(r, a, b), 0x1ece6f7f1ece6f7f, 0);
        CHECK_DSP(__nds__kmmawt2_u(r, a, b), 0x1ece6f801ece6f80, 0);
        CHECK_DSP(__nds__smbb16(a, b), 0x0cb9a4210cb9a421, 0);
        CHECK_DSP(__nds__smbt16(a, b), 0x06846c8306846c83, 0);
        CHECK_DSP(__nds__smtt16(a, b), 0x0f67528f0f67528f, 0);
        CHECK_DSP(__nds__kmda(a, b), 0x1c20f6b01c20f6b0, 0);
        CHECK_DSP(__nds__kmxda(a, b), 0x2497dd282497dd28, 0);
        CHECK_DSP(__nds__smds(a, b), 0x02adae6e02adae6e, 0);
        CHECK_DSP(__nds__smxds(a, b), 0x178f0422178f0422, 0);
        CHECK_DSP(__nds__smdrs(a, b), 0xfd525192fd525192, 0);
        CHECK_DSP(__nds__kmabb(r, a, b), 0x0cb9a4200cb9a420, 0);
        CHECK_DSP(__nds__kmabt(r, a, b), 0x06846c8206846c82, 0);
        CHECK_DSP(__nds__kmatt(r, a, b), 0x0f67528e0f67528e, 0);
        CHECK_DSP(__nds__kmada(r, a, b), 0x1c20f6af1c20f6af, 0);
        CHECK_DSP(__nds__kmaxda(r, a, b), 0x2497dd272497dd27, 0);
        CHECK_DSP(__nds__kmads(r, a, b), 0x02adae6d02adae6d, 0);
        CHECK_DSP(__nds__kmaxds(r, a, b), 0x178f0421178f0421, 0);
        CHECK_DSP(__nds__kmadrs(r, a, b), 0xfd525191fd525191, 0);
        CHECK_DSP(__nds__kmsda(r, a, b), 0xe3df094fe3df094f, 0);
        CHECK_DSP(__nds__kmsxda(r, a, b), 0xdb6822d7db6822d7, 0);
        CHECK_DSP(__nds__smal(a, b), 0x89abcdef9a9c60f5, 0);
        CHECK_DSP(__nds__smaqa(r, a, b), 0x000039a3000039a3, 0);
        CHECK_DSP(__nds__umaqa(r, a, b), 0x000261a3000261a3, 0);
        CHECK_DSP(__nds__smaqa_su(r, a, b), 0xffff29a3ffff29a3, 0);
        CHECK_DSP(__nds__pbsad(a, b), 0x00000000000000cc, 0);
        CHECK_DSP(__nds__pbsada(r, a, b), 0x00000000000000cb, 0);
        CHECK_DSP(__nds__smul16(a, b), 0x0f67528f0cb9a421, 0);
        CHECK_DSP(__nds__smulx16(a, b), 0x1e1370a506846c83, 0);
        CHECK_DSP(__nds__umul16(a, b), 0x77bf528f9997a421, 0);
        CHECK_DSP(__nds__umulx16(a, b), 0x66ad70a5b3206c83, 0);
        CHECK_DSP(__nds__smul8(a, b), 0x0fce1b8f0d260121, 0);
        CHECK_DSP(__nds__smulx8(a, b), 0x26950b4a03630462, 0);
        CHECK_DSP(__nds__umul8(a, b), 0x76ce738f9826df21, 0);
        CHECK_DSP(__nds__umulx8(a, b), 0x5c95944abf63b162, 0);
        CHECK_DSP(__nds__mulr64(a, b), 0x77c06c5d76bfa421, 0);
        CHECK_DSP(__nds__mulsr64(a, b), 0x0f66df7f76bfa421, 0);
        CHECK_DSP(__nds__sadd64(a, b), 0x68598cdf68598cde, 0);
        CHECK_DSP(__nds__radd64(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__uradd64(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__kadd64(a, b), 0x8000000000000000, 1);
        CHECK_DSP(__nds__ukadd64(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__ssub64(a, b), 0xaafe0effaafe0f00, 0);
        CHECK_DSP(__nds__rsub64(a, b), 0xd57f077fd57f0780, 0);
        CHECK_DSP(__nds__ursub64(a, b), 0xd57f077fd57f0780, 0);
        CHECK_DSP(__nds__ksub64(a, b), 0xaafe0effaafe0f00, 0);
        CHECK_DSP(__nds__uksub64(a, b), 0x0000000000000000, 1);
        CHECK_DSP(__nds__smar64(r, a, b), 0x1ecdbefeed7f4841, 0);
        CHECK_DSP(__nds__umar64(r, a, b), 0xef80d8baed7f4841, 0);
        CHECK_DSP(__nds__kmar64(r, a, b), 0x1ecdbefeed7f4841, 0);
        CHECK_DSP(__nds__ukmar64(r, a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__smsr64(r, a, b), 0x6ade0ef09c2c85ad, 0);
        CHECK_DSP(__nds__umsr64(r, a, b), 0x107f27451280b7bd, 0);
        CHECK_DSP(__nds__kmsr64(r, a, b), 0xe13241011280b7bd, 0);
        CHECK_DSP(__nds__ukmsr64(r, a, b), 0x107f27451280b7bd, 0);
        CHECK_DSP(__nds__smalbb(r, a, b), 0x0000000019734841, 0);
        CHECK_DSP(__nds__smalbt(r, a, b), 0x000000000d08d905, 0);
        CHECK_DSP(__nds__smaltt(r, a, b), 0x000000001ecea51d, 0);
        CHECK_DSP(__nds__smalda(r, a, b), 0x000000003841ed5f, 0);
        CHECK_DSP(__nds__smalxda(r, a, b), 0x00000000492fba4f, 0);
        CHECK_DSP(__nds__smalds(r, a, b), 0x00000000055b5cdb, 0);
        CHECK_DSP(__nds__smalxds(r, a, b), 0x000000002f1e0843, 0);
        CHECK_DSP(__nds__smaldrs(r, a, b), 0xfffffffffaa4a323, 0);
        CHECK_DSP(__nds__smslda(r, a, b), 0xffffffffc7be129f, 0);
        CHECK_DSP(__nds__smslxda(r, a, b), 0xffffffffb6d045af, 0);
        CHECK_DSP(__nds__kaddh(a, b), 0xffffffffffff8000, 1);
        CHECK_DSP(__nds__ukaddh(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__ksubh(a, b), 0xffffffffffff8000, 1);
        CHECK_DSP(__nds__uksubh(a, b), 0x0000000000000000, 1);
        CHECK_DSP(__nds__khmbb(a, b), 0x0000000000001973, 0);
        CHECK_DSP(__nds__khmbt(a, b), 0x0000000000000d08, 0);
        CHECK_DSP(__nds__khmtt(a, b), 0x0000000000001ece, 0);
        CHECK_DSP(__nds__kaddw(a, b), 0xffffffff80000000, 1);
        CHECK_DSP(__nds__ukaddw(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__ksubw(a, b), 0xffffffffaafe0f00, 0);
        CHECK_DSP(__nds__uksubw(a, b), 0x0000000000000000, 1);
        CHECK_DSP(__nds__kdmbb(a, b), 0x0000000019734842, 0);
        CHECK_DSP(__nds__kdmbt(a, b), 0x000000000d08d906, 0);
        CHECK_DSP(__nds__kdmtt(a, b), 0x000000001ecea51e, 0);
        CHECK_DSP(__nds__kslraw(a, b), 0xffffffffffffc4d5, 0);
        CHECK_DSP(__nds__kslraw_u(a, b), 0xffffffffffffc4d6, 0);
        CHECK_DSP(__nds__kdmabb(r, a, b), 0x0000000019734841, 0);
        CHECK_DSP(__nds__kdmabt(r, a, b), 0x000000000d08d905, 0);
        CHECK_DSP(__nds__kdmatt(r, a, b), 0x000000001ecea51d, 0);
        CHECK_DSP(__nds__ave(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__add32(a, b), 0x68598cde68598cde, 0);
        CHECK_DSP(__nds__radd32(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__uradd32(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__kadd32(a, b), 0x8000000080000000, 1);
        CHECK_DSP(__nds__ukadd32(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__sub32(a, b), 0xaafe0f00aafe0f00, 0);
        CHECK_DSP(__nds__rsub32(a, b), 0xd57f0780d57f0780, 0);
        CHECK_DSP(__nds__ursub32(a, b), 0xd57f0780d57f0780, 0);
        CHECK_DSP(__nds__ksub32(a, b), 0xaafe0f00aafe0f00, 0);
        CHECK_DSP(__nds__uksub32(a, b), 0x0000000000000000, 1);
        CHECK_DSP(__nds__stas32(a, b), 0x68598cdeaafe0f00, 0);
        CHECK_DSP(__nds__rstas32(a, b), 0xb42cc66fd57f0780, 0);
        CHECK_DSP(__nds__urstas32(a, b), 0xb42cc66fd57f0780, 0);
        CHECK_DSP(__nds__kstas32(a, b), 0x80000000aafe0f00, 1);
        CHECK_DSP(__nds__ukstas32(a, b), 0xffffffff00000000, 1);
        CHECK_DSP(__nds__stsa32(a, b), 0xaafe0f0068598cde, 0);
        CHECK_DSP(__nds__rstsa32(a, b), 0xd57f0780b42cc66f, 0);
        CHECK_DSP(__nds__urstsa32(a, b), 0xd57f0780b42cc66f, 0);
        CHECK_DSP(__nds__kstsa32(a, b), 0xaafe0f0080000000, 1);
        CHECK_DSP(__nds__ukstsa32(a, b), 0x00000000ffffffff, 1);
        CHECK_DSP(__nds__cras32(a, b), 0x68598cdeaafe0f00, 0);
        CHECK_DSP(__nds__rcras32(a, b), 0xb42cc66fd57f0780, 0);
        CHECK_DSP(__nds__urcras32(a, b), 0xb42cc66fd57f0780, 0);
        CHECK_DSP(__nds__kcras32(a, b), 0x80000000aafe0f00, 1);
        CHECK_DSP(__nds__ukcras32(a, b), 0xffffffff00000000, 1);
        CHECK_DSP(__nds__crsa32(a, b), 0xaafe0f0068598cde, 0);
        CHECK_DSP(__nds__rcrsa32(a, b), 0xd57f0780b42cc66f, 0);
        CHECK_DSP(__nds__urcrsa32(a, b), 0xd57f0780b42cc66f, 0);
        CHECK_DSP(__nds__kcrsa32(a, b), 0xaafe0f0080000000, 1);
        CHECK_DSP(__nds__ukcrsa32(a, b), 0x00000000ffffffff, 1);
        CHECK_DSP(__nds__sra32(a, b), 0xffff1357ffff1357, 0);
        CHECK_DSP(__nds__sra32(a, 0x1F), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__sra32_u(a, b), 0xffff1358ffff1358, 0);
        CHECK_DSP(__nds__sra32_u(a, 0x1F), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__srl32(a, b), 0x0001135700011357, 0);
        CHECK_DSP(__nds__srl32(a, 0x1F), 0x0000000100000001, 0);
        CHECK_DSP(__nds__srl32_u(a, b), 0x0001135800011358, 0);
        CHECK_DSP(__nds__srl32_u(a, 0x1F), 0x0000000100000001, 0);
        CHECK_DSP(__nds__sll32(a, b), 0xe6f78000e6f78000, 0);
        CHECK_DSP(__nds__sll32(a, 0x1F), 0x8000000080000000, 0);
        CHECK_DSP(__nds__ksll32(a, b), 0x8000000080000000, 1);
        CHECK_DSP(__nds__ksll32(a, 0x1F), 0x8000000080000000, 1);
        CHECK_DSP(__nds__kslra32(a, b), 0xffffc4d5ffffc4d5, 0);
        CHECK_DSP(__nds__kslra32_u(a, b), 0xffffc4d6ffffc4d6, 0);
        CHECK_DSP(__nds__smin32(a, b), 0x89abcdef89abcdef, 0);
        CHECK_DSP(__nds__umin32(a, b), 0x89abcdef89abcdef, 0);
        CHECK_DSP(__nds__smax32(a, b), 0xdeadbeefdeadbeef, 0);
        CHECK_DSP(__nds__umax32(a, b), 0xdeadbeefdeadbeef, 0);
        CHECK_DSP(__nds__kabs32(a), 0x7654321176543211, 0);
        CHECK_DSP(__nds__sraiw_u(a, 0x1F), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__smbb32(a, b), 0x0f66df7f76bfa421, 0);
        CHECK_DSP(__nds__smbt32(a, b), 0x0f66df7f76bfa421, 0);
        CHECK_DSP(__nds__smtt32(a, b), 0x0f66df7f76bfa421, 0);
        CHECK_DSP(__nds__kmda32(a, b), 0x1ecdbefeed7f4842, 0);
        CHECK_DSP(__nds__kmxda32(a, b), 0x1ecdbefeed7f4842, 0);
        CHECK_DSP(__nds__smds32(a, b), 0x0000000000000000, 0);
        CHECK_DSP(__nds__smxds32(a, b), 0x0000000000000000, 0);
        CHECK_DSP(__nds__smdrs32(a, b), 0x0000000000000000, 0);
        CHECK_DSP(__nds__kmabb32(r, a, b), 0x0f66df7f76bfa420, 0);
        CHECK_DSP(__nds__kmabt32(r, a, b), 0x0f66df7f76bfa420, 0);
        CHECK_DSP(__nds__kmatt32(r, a, b), 0x0f66df7f76bfa420, 0);
        CHECK_DSP(__nds__kmada32(r, a, b), 0x1ecdbefeed7f4841, 0);
        CHECK_DSP(__nds__kmaxda32(r, a, b), 0x1ecdbefeed7f4841, 0);
        CHECK_DSP(__nds__kmads32(r, a, b), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__kmaxds32(r, a, b), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__kmadrs32(r, a, b), 0xffffffffffffffff, 0);
        CHECK_DSP(__nds__kmsda32(r, a, b), 0xe13241011280b7bd, 0);
        CHECK_DSP(__nds__kmsxda32(r, a, b), 0xe13241011280b7bd, 0);
        CHECK_DSP(__nds__khmbb16(a, b), 0x0000197300001973, 0);
        CHECK_DSP(__nds__khmbt16(a, b), 0x00000d0800000d08, 0);
        CHECK_DSP(__nds__khmtt16(a, b), 0x00001ece00001ece, 0);
        CHECK_DSP(__nds__kdmbb16(a, b), 0x1973484219734842, 0);
        CHECK_DSP(__nds__kdmbt16(a, b), 0x0d08d9060d08d906, 0);
        CHECK_DSP(__nds__kdmtt16(a, b), 0x1ecea51e1ecea51e, 0);
        CHECK_DSP(__nds__kdmabb16(r, a, b), 0x1973484119734841, 0);
        CHECK_DSP(__nds__kdmabt16(r, a, b), 0x0d08d9050d08d905, 0);
        CHECK_DSP(__nds__kdmatt16(r, a, b), 0x1ecea51d1ecea51d, 0);
        CHECK_DSP(__nds__pkbb32(a, b), 0x89abcdefdeadbeef, 0);
        CHECK_DSP(__nds__pkbt32(a, b), 0x89abcdefdeadbeef, 0);
        CHECK_DSP(__nds__pktb32(a, b), 0x89abcdefdeadbeef, 0);
        CHECK_DSP(__nds__pktt32(a, b), 0x89abcdefdeadbeef, 0);
#else
        CHECK_DSP(__nds__add16(a, b), 0x68588cde, 0);
        CHECK_DSP(__nds__radd16(a, b), 0xb42cc66f, 0);
        CHECK_DSP(__nds__uradd16(a, b), 0xb42cc66f, 0);
        CHECK_DSP(__nds__kadd16(a, b), 0x80008cde, 1);
        CHECK_DSP(__nds__ukadd16(a, b), 0xffffffff, 1);
        CHECK_DSP(__nds__sub16(a, b), 0xaafe0f00, 0);
        CHECK_DSP(__nds__rsub16(a, b), 0xd57f0780, 0);
        CHECK_DSP(__nds__ursub16(a, b), 0xd57f0780, 0);
        CHECK_DSP(__nds__ksub16(a, b), 0xaafe0f00, 0);
        CHECK_DSP(__nds__uksub16(a, b), 0x00000f00, 1);
        CHECK_DSP(__nds__stas16(a, b), 0x68580f00, 0);
        CHECK_DSP(__nds__rstas16(a, b), 0xb42c0780, 0);
        CHECK_DSP(__nds__urstas16(a, b), 0xb42c0780, 0);
        CHECK_DSP(__nds__kstas16(a, b), 0x80000f00, 1);
        CHECK_DSP(__nds__ukstas16(a, b), 0xffff0f00, 1);
        CHECK_DSP(__nds__stsa16(a, b), 0xaafe8cde, 0);
        CHECK_DSP(__nds__rstsa16(a, b), 0xd57fc66f, 0);
        CHECK_DSP(__nds__urstsa16(a, b), 0xd57fc66f, 0);
        CHECK_DSP(__nds__kstsa16(a, b), 0xaafe8cde, 0);
        CHECK_DSP(__nds__ukstsa16(a, b), 0x0000ffff, 1);
        CHECK_DSP(__nds__cras16(a, b), 0x489aef42, 0);
        CHECK_DSP(__nds__rcras16(a, b), 0xa44df7a1, 0);
        CHECK_DSP(__nds__urcras16(a, b), 0xa44df7a1, 0);
        CHECK_DSP(__nds__kcras16(a, b), 0x8000ef42, 1);
        CHECK_DSP(__nds__ukcras16(a, b), 0xffff0000, 1);
        CHECK_DSP(__nds__crsa16(a, b), 0xcabcac9c, 0);
        CHECK_DSP(__nds__rcrsa16(a, b), 0xe55ed64e, 0);
        CHECK_DSP(__nds__urcrsa16(a, b), 0xe55ed64e, 0);
        CHECK_DSP(__nds__kcrsa16(a, b), 0xcabcac9c, 0);
        CHECK_DSP(__nds__ukcrsa16(a, b), 0x0000ffff, 1);
        CHECK_DSP(__nds__sra16(a, b), 0xffffffff, 0);
        CHECK_DSP(__nds__sra16(a, 0xF), 0xffffffff, 0);
        CHECK_DSP(__nds__sra16_u(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__sra16_u(a, 0xF), 0xffff0000, 0);
        CHECK_DSP(__nds__srl16(a, b), 0x00010001, 0);
        CHECK_DSP(__nds__srl16(a, 0xF), 0x00010001, 0);
        CHECK_DSP(__nds__srl16_u(a, b), 0x00010002, 0);
        CHECK_DSP(__nds__srl16_u(a, 0xF), 0x00010002, 0);
        CHECK_DSP(__nds__sll16(a, b), 0x80008000, 0);
        CHECK_DSP(__nds__sll16(a, 0xF), 0x80008000, 0);
        CHECK_DSP(__nds__ksll16(a, b), 0x80008000, 1);
        CHECK_DSP(__nds__ksll16(a, 0xF), 0x80008000, 1);
        CHECK_DSP(__nds__kslra16(a, b), 0x80008000, 1);
        CHECK_DSP(__nds__kslra16_u(a, b), 0x80008000, 1);
        CHECK_DSP(__nds__cmpeq16(a, b), 0x00000000, 0);
        CHECK_DSP(__nds__scmplt16(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__ucmplt16(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__scmple16(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__ucmple16(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__smin16(a, b), 0x89abbeef, 0);
        CHECK_DSP(__nds__umin16(a, b), 0x89abbeef, 0);
        CHECK_DSP(__nds__smax16(a, b), 0xdeadcdef, 0);
        CHECK_DSP(__nds__umax16(a, b), 0xdeadcdef, 0);
        CHECK_DSP(__nds__kabs16(a), 0x76553211, 0);
        CHECK_DSP(__nds__sclip16(a, 0xF), 0x89abcdef, 0);
        CHECK_DSP(__nds__uclip16(a, 0xF), 0x00000000, 1);
        CHECK_DSP(__nds__khm16(a, b), 0x1ece1973, 0);
        CHECK_DSP(__nds__khmx16(a, b), 0x3c260d08, 0);
        CHECK_DSP(__nds__swap16(a), 0xcdef89ab, 0);
        CHECK_DSP(__nds__clz16(a), 0x00000000, 0);
        CHECK_DSP(__nds__clo16(a), 0x00010002, 0);
        CHECK_DSP(__nds__clrs16(a), 0x00000001, 0);
        CHECK_DSP(__nds__add8(a, b), 0x67588bde, 0);
        CHECK_DSP(__nds__radd8(a, b), 0xb3acc5ef, 0);
        CHECK_DSP(__nds__uradd8(a, b), 0xb3acc5ef, 0);
        CHECK_DSP(__nds__kadd8(a, b), 0x80808bde, 1);
        CHECK_DSP(__nds__ukadd8(a, b), 0xffffffff, 1);
        CHECK_DSP(__nds__sub8(a, b), 0xabfe0f00, 0);
        CHECK_DSP(__nds__rsub8(a, b), 0xd5ff0700, 0);
        CHECK_DSP(__nds__ursub8(a, b), 0xd5ff0700, 0);
        CHECK_DSP(__nds__ksub8(a, b), 0xabfe0f00, 0);
        CHECK_DSP(__nds__uksub8(a, b), 0x00000f00, 1);
        CHECK_DSP(__nds__sra8(a, b), 0xffffffff, 0);
        CHECK_DSP(__nds__sra8(a, 0x7), 0xffffffff, 0);
        CHECK_DSP(__nds__sra8_u(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__sra8_u(a, 0x7), 0xffff0000, 0);
        CHECK_DSP(__nds__srl8(a, b), 0x01010101, 0);
        CHECK_DSP(__nds__srl8(a, 0x7), 0x01010101, 0);
        CHECK_DSP(__nds__srl8_u(a, b), 0x01010202, 0);
        CHECK_DSP(__nds__srl8_u(a, 0x7), 0x01010202, 0);
        CHECK_DSP(__nds__sll8(a, b), 0x80808080, 0);
        CHECK_DSP(__nds__sll8(a, 0x7), 0x80808080, 0);
        CHECK_DSP(__nds__ksll8(a, b), 0x80808080, 1);
        CHECK_DSP(__nds__ksll8(a, 0x7), 0x80808080, 1);
        CHECK_DSP(__nds__kslra8(a, b), 0xc4d5e6f7, 0);
        CHECK_DSP(__nds__kslra8_u(a, b), 0xc5d6e7f8, 0);
        CHECK_DSP(__nds__cmpeq8(a, b), 0x000000ff, 0);
        CHECK_DSP(__nds__scmplt8(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__ucmplt8(a, b), 0xffff0000, 0);
        CHECK_DSP(__nds__scmple8(a, b), 0xffff00ff, 0);
        CHECK_DSP(__nds__ucmple8(a, b), 0xffff00ff, 0);
        CHECK_DSP(__nds__smin8(a, b), 0x89abbeef, 0);
        CHECK_DSP(__nds__umin8(a, b), 0x89abbeef, 0);
        CHECK_DSP(__nds__smax8(a, b), 0xdeadcdef, 0);
        CHECK_DSP(__nds__umax8(a, b), 0xdeadcdef, 0);
        CHECK_DSP(__nds__kabs8(a), 0x77553311, 0);
        CHECK_DSP(__nds__sclip8(a, 0x7), 0x89abcdef, 0);
        CHECK_DSP(__nds__uclip8(a, 0x7), 0x00000000, 1);
        CHECK_DSP(__nds__khm8(a, b), 0x1f371a02, 0);
        CHECK_DSP(__nds__khmx8(a, b), 0x4d160608, 0);
        CHECK_DSP(__nds__swap8(a), 0xab89efcd, 0);
        CHECK_DSP(__nds__clz8(a), 0x00000000, 0);
        CHECK_DSP(__nds__clo8(a), 0x01010203, 0);
        CHECK_DSP(__nds__clrs8(a), 0x00000102, 0);
        CHECK_DSP(__nds__sunpkd810(a), 0xffcdffef, 0);
        CHECK_DSP(__nds__sunpkd820(a), 0xffabffef, 0);
        CHECK_DSP(__nds__sunpkd830(a), 0xff89ffef, 0);
        CHECK_DSP(__nds__sunpkd831(a), 0xff89ffcd, 0);
        CHECK_DSP(__nds__sunpkd832(a), 0xff89ffab, 0);
        CHECK_DSP(__nds__zunpkd810(a), 0x00cd00ef, 0);
        CHECK_DSP(__nds__zunpkd820(a), 0x00ab00ef, 0);
        CHECK_DSP(__nds__zunpkd830(a), 0x008900ef, 0);
        CHECK_DSP(__nds__zunpkd831(a), 0x008900cd, 0);
        CHECK_DSP(__nds__zunpkd832(a), 0x008900ab, 0);
        CHECK_DSP(__nds__raddw(a, b), 0xb42cc66f, 0);
        CHECK_DSP(__nds__uraddw(a, b), 0xb42cc66f, 0);
        CHECK_DSP(__nds__rsubw(a, b), 0xd57f0780, 0);
        CHECK_DSP(__nds__ursubw(a, b), 0xd57f0780, 0);
        CHECK_DSP(__nds__sra_u(a, b), 0xffff1358, 0);
        CHECK_DSP(__nds__sra_u(a, 0x1F), 0xffffffff, 0);
        CHECK_DSP(__nds__ksllw(a, b), 0x80000000, 1);
        CHECK_DSP(__nds__ksllw(a, 0x1F), 0x80000000, 1);
        CHECK_DSP(__nds__pkbb16(a, b), 0xcdefbeef, 0);
        CHECK_DSP(__nds__pkbt16(a, b), 0xcdefdead, 0);
        CHECK_DSP(__nds__pktb16(a, b), 0x89abbeef, 0);
        CHECK_DSP(__nds__pktt16(a, b), 0x89abdead, 0);
        CHECK_DSP(__nds__sclip32(a, 0x1F), 0x89abcdef, 0);
        CHECK_DSP(__nds__uclip32(a, 0x1F), 0x00000000, 1);
        CHECK_DSP(__nds__bitrev(a, b), 0x0000f7b3, 0);
        CHECK_DSP(__nds__bitrev(a, 0x1F), 0xf7b3d591, 0);
        CHECK_DSP(__nds__wext(a, b), 0x9bdf1357, 0);
        CHECK_DSP(__nds__wext(a, 0x1F), 0x13579bdf, 0);
        CHECK_DSP(__nds__bpick(r, a, b), 0xdfafffef, 0);
        CHECK_DSP(__nds__insb(r, a, 0x2), 0xffefffff, 0);
        CHECK_DSP(__nds__minw(a, b), 0x89abcdef, 0);
        CHECK_DSP(__nds__maxw(a, b), 0xdeadbeef, 0);
        CHECK_DSP(__nds__kabsw(a), 0x76543211, 0);
        CHECK_DSP(__nds__clz32(a), 0x00000000, 0);
        CHECK_DSP(__nds__clo32(a), 0x00000001, 0);
        CHECK_DSP(__nds__clrs32(a), 0x00000000, 0);
        CHECK_DSP(__nds__smmul(a, b), 0x0f66df7f, 0);
        CHECK_DSP(__nds__smmul_u(a, b), 0x0f66df7f, 0);
        CHECK_DSP(__nds__kmmac(r, a, b), 0x0f66df7e, 0);
        CHECK_DSP(__nds__kmmac_u(r, a, b), 0x0f66df7e, 0);
        CHECK_DSP(__nds__kmmsb(r, a, b), 0xf0992080, 0);
        CHECK_DSP(__nds__kmmsb_u(r, a, b), 0xf0992080, 0);
        CHECK_DSP(__nds__kwmmul(a, b), 0x1ecdbefe, 0);
        CHECK_DSP(__nds__kwmmul_u(a, b), 0x1ecdbeff, 0);
        CHECK_DSP(__nds__maddr32(r, a, b), 0x76bfa420, 0);
        CHECK_DSP(__nds__msubr32(r, a, b), 0x89405bde, 0);
        CHECK_DSP(__nds__smmwb(a, b), 0x1e133c4d, 0);
        CHECK_DSP(__nds__smmwb_u(a, b), 0x1e133c4e, 0);
        CHECK_DSP(__nds__smmwt(a, b), 0x0f6737c0, 0);
        CHECK_DSP(__nds__smmwt_u(a, b), 0x0f6737c0, 0);
        CHECK_DSP(__nds__kmmawb(r, a, b), 0x1e133c4c, 0);
        CHECK_DSP(__nds__kmmawb_u(r, a, b), 0x1e133c4d, 0);
        CHECK_DSP(__nds__kmmawt(r, a, b), 0x0f6737bf, 0);
        CHECK_DSP(__nds__kmmawt_u(r, a, b), 0x0f6737bf, 0);
        CHECK_DSP(__nds__kmmwb2(a, b), 0x3c26789b, 0);
        CHECK_DSP(__nds__kmmwb2_u(a, b), 0x3c26789b, 0);
        CHECK_DSP(__nds__kmmwt2(a, b), 0x1ece6f80, 0);
        CHECK_DSP(__nds__kmmwt2_u(a, b), 0x1ece6f81, 0);
        CHECK_DSP(__nds__kmmawb2(r, a, b), 0x3c26789a, 0);
        CHECK_DSP(__nds__kmmawb2_u(r, a, b), 0x3c26789a, 0);
        CHECK_DSP(__nds__kmmawt2(r, a, b), 0x1ece6f7f, 0);
        CHECK_DSP(__nds__kmmawt2_u(r, a, b), 0x1ece6f80, 0);
        CHECK_DSP(__nds__smbb16(a, b), 0x0cb9a421, 0);
        CHECK_DSP(__nds__smbt16(a, b), 0x06846c83, 0);
        CHECK_DSP(__nds__smtt16(a, b), 0x0f67528f, 0);
        CHECK_DSP(__nds__kmda(a, b), 0x1c20f6b0, 0);
        CHECK_DSP(__nds__kmxda(a, b), 0x2497dd28, 0);
        CHECK_DSP(__nds__smds(a, b), 0x02adae6e, 0);
        CHECK_DSP(__nds__smxds(a, b), 0x178f0422, 0);
        CHECK_DSP(__nds__smdrs(a, b), 0xfd525192, 0);
        CHECK_DSP(__nds__kmabb(r, a, b), 0x0cb9a420, 0);
        CHECK_DSP(__nds__kmabt(r, a, b), 0x06846c82, 0);
        CHECK_DSP(__nds__kmatt(r, a, b), 0x0f67528e, 0);
        CHECK_DSP(__nds__kmada(r, a, b), 0x1c20f6af, 0);
        CHECK_DSP(__nds__kmaxda(r, a, b), 0x2497dd27, 0);
        CHECK_DSP(__nds__kmads(r, a, b), 0x02adae6d, 0);
        CHECK_DSP(__nds__kmaxds(r, a, b), 0x178f0421, 0);
        CHECK_DSP(__nds__kmadrs(r, a, b), 0xfd525191, 0);
        CHECK_DSP(__nds__kmsda(r, a, b), 0xe3df094f, 0);
        CHECK_DSP(__nds__kmsxda(r, a, b), 0xdb6822d7, 0);
        CHECK_DSP(__nds__smal(a, b), 0x89abcdef92241772, 0);
        CHECK_DSP(__nds__smaqa(r, a, b), 0x000039a3, 0);
        CHECK_DSP(__nds__umaqa(r, a, b), 0x000261a3, 0);
        CHECK_DSP(__nds__smaqa_su(r, a, b), 0xffff29a3, 0);
        CHECK_DSP(__nds__pbsad(a, b), 0x00000066, 0);
        CHECK_DSP(__nds__pbsada(r, a, b), 0x00000065, 0);
        CHECK_DSP(__nds__smul16(a, b), 0x0f67528f0cb9a421, 0);
        CHECK_DSP(__nds__smulx16(a, b), 0x1e1370a506846c83, 0);
        CHECK_DSP(__nds__umul16(a, b), 0x77bf528f9997a421, 0);
        CHECK_DSP(__nds__umulx16(a, b), 0x66ad70a5b3206c83, 0);
        CHECK_DSP(__nds__smul8(a, b), 0x0fce1b8f0d260121, 0);
        CHECK_DSP(__nds__smulx8(a, b), 0x26950b4a03630462, 0);
        CHECK_DSP(__nds__umul8(a, b), 0x76ce738f9826df21, 0);
        CHECK_DSP(__nds__umulx8(a, b), 0x5c95944abf63b162, 0);
        CHECK_DSP(__nds__mulr64(a, b), 0x77c06c5d76bfa421, 0);
        CHECK_DSP(__nds__mulsr64(a, b), 0x0f66df7f76bfa421, 0);
        CHECK_DSP(__nds__sadd64(a, b), 0x68598cdf68598cde, 0);
        CHECK_DSP(__nds__radd64(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__uradd64(a, b), 0xb42cc66fb42cc66f, 0);
        CHECK_DSP(__nds__kadd64(a, b), 0x8000000000000000, 1);
        CHECK_DSP(__nds__ukadd64(a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__ssub64(a, b), 0xaafe0effaafe0f00, 0);
        CHECK_DSP(__nds__rsub64(a, b), 0xd57f077fd57f0780, 0);
        CHECK_DSP(__nds__ursub64(a, b), 0xd57f077fd57f0780, 0);
        CHECK_DSP(__nds__ksub64(a, b), 0xaafe0effaafe0f00, 0);
        CHECK_DSP(__nds__uksub64(a, b), 0x0000000000000000, 1);
        CHECK_DSP(__nds__smar64(r, a, b), 0x0f66df7f76bfa420, 0);
        CHECK_DSP(__nds__umar64(r, a, b), 0x77c06c5d76bfa420, 0);
        CHECK_DSP(__nds__kmar64(r, a, b), 0x0f66df7f76bfa420, 0);
        CHECK_DSP(__nds__ukmar64(r, a, b), 0xffffffffffffffff, 1);
        CHECK_DSP(__nds__smsr64(r, a, b), 0xf099208089405bde, 0);
        CHECK_DSP(__nds__umsr64(r, a, b), 0x883f93a289405bde, 0);
        CHECK_DSP(__nds__kmsr64(r, a, b), 0xf099208089405bde, 0);
        CHECK_DSP(__nds__ukmsr64(r, a, b), 0x883f93a289405bde, 0);
        CHECK_DSP(__nds__smalbb(r, a, b), 0x000000000cb9a420, 0);
        CHECK_DSP(__nds__smalbt(r, a, b), 0x0000000006846c82, 0);
        CHECK_DSP(__nds__smaltt(r, a, b), 0x000000000f67528e, 0);
        CHECK_DSP(__nds__smalda(r, a, b), 0x000000001c20f6af, 0);
        CHECK_DSP(__nds__smalxda(r, a, b), 0x000000002497dd27, 0);
        CHECK_DSP(__nds__smalds(r, a, b), 0x0000000002adae6d, 0);
        CHECK_DSP(__nds__smalxds(r, a, b), 0x00000000178f0421, 0);
        CHECK_DSP(__nds__smaldrs(r, a, b), 0xfffffffffd525191, 0);
        CHECK_DSP(__nds__smslda(r, a, b), 0xffffffffe3df094f, 0);
        CHECK_DSP(__nds__smslxda(r, a, b), 0xffffffffdb6822d7, 0);
        CHECK_DSP(__nds__kaddh(a, b), 0xffff8000, 1);
        CHECK_DSP(__nds__ukaddh(a, b), 0xffffffff, 1);
        CHECK_DSP(__nds__ksubh(a, b), 0xffff8000, 1);
        CHECK_DSP(__nds__uksubh(a, b), 0x00000000, 1);
        CHECK_DSP(__nds__khmbb(a, b), 0x00001973, 0);
        CHECK_DSP(__nds__khmbt(a, b), 0x00000d08, 0);
        CHECK_DSP(__nds__khmtt(a, b), 0x00001ece, 0);
        CHECK_DSP(__nds__kaddw(a, b), 0x80000000, 1);
        CHECK_DSP(__nds__ukaddw(a, b), 0xffffffff, 1);
        CHECK_DSP(__nds__ksubw(a, b), 0xaafe0f00, 0);
        CHECK_DSP(__nds__uksubw(a, b), 0x00000000, 1);
        CHECK_DSP(__nds__kdmbb(a, b), 0x19734842, 0);
        CHECK_DSP(__nds__kdmbt(a, b), 0x0d08d906, 0);
        CHECK_DSP(__nds__kdmtt(a, b), 0x1ecea51e, 0);
        CHECK_DSP(__nds__kslraw(a, b), 0xffffc4d5, 0);
        CHECK_DSP(__nds__kslraw_u(a, b), 0xffffc4d6, 0);
        CHECK_DSP(__nds__kdmabb(r, a, b), 0x19734841, 0);
        CHECK_DSP(__nds__kdmabt(r, a, b), 0xd08d905, 0);
        CHECK_DSP(__nds__kdmatt(r, a, b), 0x1ecea51d, 0);
        CHECK_DSP(__nds__ave(a, b), 0xb42cc66f, 0);
#endif
}
